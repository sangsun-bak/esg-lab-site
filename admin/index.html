<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>관리자 | 소식/이벤트 게시판</title>
  <meta name="robots" content="noindex">
  <link rel="stylesheet" href="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.css">
</head>
<body>
  <!-- Netlify Identity Widget for login -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  <script>
    // Redirect to site after logout/login if needed
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on('init', user => {
        if (!user) {
          window.netlifyIdentity.on('login', () => { document.location.href = '/admin/'; });
        }
      });
    }
  </script>

<script>
  // Normalize invite token in query to hash for the widget
  (function(){
    try {
      var params = new URLSearchParams(window.location.search);
      var token = params.get('invite_token');
      if (token && window.location.hash.indexOf('invite_token=') === -1) {
        window.location.replace(window.location.pathname + '#/invite_token=' + token);
      }
    } catch(e) {}
  })();
  if (window.netlifyIdentity) {
    // Ensure widget boot if hash already set
    window.netlifyIdentity.on('init', function(user){
      if (!user && window.location.hash.indexOf('invite_token=') !== -1) {
        // The widget should auto-handle; ensure panel opens
        try { window.netlifyIdentity.open('login'); } catch(e) {}
      }
    });
  }
</script>

</body>
</html>
