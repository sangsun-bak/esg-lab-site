<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CMS | ESG 경영연구소</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--green:#0B7A4B;--ink:#111827;--muted:#6b7280}
    *{box-sizing:border-box}html,body{margin:0;padding:0;background:#fff;color:var(--ink);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,'맑은 고딕',sans-serif}
    /* Custom toolbar */
    .toolbar{position:fixed;top:0;left:0;right:0;height:48px;display:flex;align-items:center;gap:10px;padding:0 12px;background:#f7faf9;border-bottom:1px solid #e5e7eb;z-index:9998}
    .toolbar a,.toolbar button{border:1px solid #d1d5db;background:#fff;border-radius:10px;padding:6px 10px;text-decoration:none;color:#111827;font-size:14px}
    .toolbar .primary{background:var(--green);color:#fff;border-color:transparent}
    .cms-root{margin-top:48px}
    /* Keep Decap header visible so Publish/Save buttons appear */
    /* Light tidy: reduce header shadow/spacing only */
    .nc-appHeader, .nc-appBar { box-shadow:none !important; }
    .nc-appHeader { border-bottom:1px solid #e5e7eb !important; }
  </style>
</head>
<body>
  <div class="toolbar">
    <a href="/admin/" class="primary">← 대시보드로</a>
    <button onclick="openCollection('news')">소식/이벤트</button>
    <button onclick="openCollection('pubs')">발간저널</button>
    <span style="color:var(--muted);font-size:13px;margin-left:6px">상단 Decap 헤더의 저장/게시 버튼을 사용하세요</span>
  </div>

  <div class="cms-root"></div>

  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  <script>
    // Prevent multiple token rewrites
    (function ensureInviteTokenOnce(){
      try {
        const key='invite_token_fixed';
        if(sessionStorage.getItem(key)) return;
        const u = new URL(location.href);
        const token = u.searchParams.get('invite_token');
        if (token && !location.hash.includes('invite_token')) {
          sessionStorage.setItem(key,'1');
          location.replace('/admin/cms.html#/invite_token=' + token);
        }
      } catch(e){}
    })();

    function openCollection(name){
      const base = '/admin/cms.html#/collections/';
      const url = base + encodeURIComponent(name);
      if (location.href !== url) location.href = url;
    }
  </script>
</body>
</html>
